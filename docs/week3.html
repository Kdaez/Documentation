<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Week 3 (1/21 to 1/28) &mdash; Nerd Herd Documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Week 2 (1/13 to 1/20)" href="week2.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Nerd Herd Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="home.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Charged Up 2023:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="january7.html">January 7th Meeting</a></li>
<li class="toctree-l1"><a class="reference internal" href="january8.html">January 8th Meeting</a></li>
<li class="toctree-l1"><a class="reference internal" href="january9.html">January 9th Meeting</a></li>
<li class="toctree-l1"><a class="reference internal" href="week2.html">Week 2 (1/13 - 1/20)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Week 3 (1/21 - 1/28)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#assembly">Assembly</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cad">CAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="#manufacturing">Manufacturing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#programming">Programming</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vision-group">Vision Group</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">1/23</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">1/27</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">1/28</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#swerve-drive-group">Swerve Drive Group</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Nerd Herd Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Week 3 (1/21 to 1/28)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/week3.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="week-3-1-21-to-1-28">
<h1>Week 3 (1/21 to 1/28)<a class="headerlink" href="#week-3-1-21-to-1-28" title="Permalink to this heading"></a></h1>
<div class="admonition-under-construction admonition">
<p class="admonition-title">Under Construction</p>
<p>This page is currently under construction. Please return later for more updates.</p>
</div>
<div class="section" id="assembly">
<h2>Assembly<a class="headerlink" href="#assembly" title="Permalink to this heading"></a></h2>
</div>
<div class="section" id="cad">
<h2>CAD<a class="headerlink" href="#cad" title="Permalink to this heading"></a></h2>
</div>
<div class="section" id="manufacturing">
<h2>Manufacturing<a class="headerlink" href="#manufacturing" title="Permalink to this heading"></a></h2>
</div>
<div class="section" id="programming">
<h2>Programming<a class="headerlink" href="#programming" title="Permalink to this heading"></a></h2>
<div class="section" id="vision-group">
<h3>Vision Group<a class="headerlink" href="#vision-group" title="Permalink to this heading"></a></h3>
<div class="section" id="id1">
<h4>1/23<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h4>
<p>We got the April Tag and Object Detection to work on a single limelight. The 4 objects being the cones, cubes, tape, and April Tags. Our code allows us to have the robot drive toward a target object while also making any angle corrections along the way.</p>
<p><img alt="Tank drive in front of target" src="images%5CWeek3%5CprgVision1.png" /></p>
<p>Later in the day, we refactored the aimAt_Object_() methods into one aimAt() method which allows the code to choose to target any of the 4 object types in one line only by entering in an enum: “CONE”, “CUBE”, “TAPE”, “TAG”.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">TargetType</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">CONE</span><span class="p">,</span>
<span class="w">   </span><span class="n">CUBE</span><span class="p">,</span>
<span class="w">   </span><span class="n">TAPE</span><span class="p">,</span>
<span class="w">   </span><span class="n">TAG</span><span class="w"> </span>
<span class="p">}</span>
</pre></div>
</div>
<p>The object detection works so well that we can tape an object to a moving person and have the robot chase them around completely autonomously. As an extra feature, we implemented a move back algorithm which has the robot drive backwards if the object were to get too close.</p>
</div>
<div class="section" id="id2">
<h4>1/27<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h4>
<p>We worked on implementing vision with the swerve drive. We did this by creating a command that combined the turnToAngle command and the driveToTarget command. We were able to test our code on the actual swerve drive, but it didn’t work. One of the possible errors was that the PID values needed to be tuned a little bit.</p>
<p><img alt="Swerve in front of target" src="_images/prgVision2.png" /></p>
<p><em>DriveToTarget testing, robot oscillated in place</em></p>
</div>
<div class="section" id="id3">
<h4>1/28<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h4>
<p>We refactored our code for vision with the swerve drive. We switched the xSpeed and ySpeed values because the y and x axes are switched.</p>
<p>Tested the previously broken limelight and it works now. Also reflashed the limelight with photonvision firmware to have limelight firmware.</p>
<p>Tested our refactored code. The code seems to work but the values were flickering because the limelight was wavering between not detecting the apriltag and detecting the apriltag. So, we need to tune the limelight more.</p>
<p><img alt="Limelight" src="_images/prgVision3.png" /></p>
<p><em>Previously broken but now functional limelight</em></p>
</div>
</div>
<div class="section" id="swerve-drive-group">
<h3>Swerve Drive Group<a class="headerlink" href="#swerve-drive-group" title="Permalink to this heading"></a></h3>
<p>This week, we worked on writing and testing auto paths.</p>
<p>First, we tested a simple auto path that moved in a 1-by-1 meter square. While testing, we found that our odometry calculations were incorrect and were missing compensation for the swerve modules’ gear ratio. After adding the gear ratio into the calculation, we found that the auto path worked relatively well, although it was not accurate over long distances on concrete.</p>
<p>Afterwards, we tested a longer auto that started on the right side of the field, “scored,” picked up a game piece, “scored,” picked up another game piece, “scored,” and then went to the charging station. We found that this auto worked relatively reliably on carpet but took too long to run. Even after increasing our max velocity and acceleration for the auto, we found that we could not score the third game piece in time.</p>
<p>During driver testing of the swerve drive, they suggested adding a stow command, which turns all wheels to a 45-degree angle to make the swerve drive impossible to move, as well as adding turn to 0- and 180-degree commands to the driver controls, as this gave them easier maneuverability. After implementing these commands, we tuned the PID values on our swerve modules’ turning motors, as they were overshooting before. We used the live graphs from AdvantageScope in order to tune the PID.</p>
<p>Lastly, we then tested integrating our balancing command into the auto. We created a new auto that directly went to the charging station, and then tested it on our charging station mockup. We found that, although it worked, the charging was slow due to us not having a separate P-gain value for initially climbing up the ramp.</p>
<p><img alt="Swerve" src="_images/prgSwerve1.gif" /></p>
<p>Because of this, we modified our auto to have two stages for the charging: one with a higher P-gain for going up the ramp, and one with the original P-gain for balancing once on the charging station. We then tested stowing the wheels at the end of the command but found that it was unreliable and sometimes would even cause the swerve drive to slowly slide off the ramp.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">TimedBalancingAct</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">SequentialCommandGroup</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">TimedBalancingAct</span><span class="p">(</span><span class="n">SwerveDrivetrain</span><span class="w"> </span><span class="n">swerveDrive</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">period1</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">kP1</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">kP2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">super</span><span class="p">(</span>
<span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">ParallelRaceGroup</span><span class="p">(</span>
<span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">WaitCommand</span><span class="p">(</span><span class="n">period1</span><span class="p">),</span>
<span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">TheGreatBalancingAct</span><span class="p">(</span><span class="n">swerveDrive</span><span class="p">,</span><span class="w"> </span><span class="n">kP1</span><span class="p">)</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">TheGreatBalancingAct</span><span class="p">(</span><span class="n">swerveDrive</span><span class="p">,</span><span class="w"> </span><span class="n">kP2</span><span class="p">)</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Our timed balancing command</em></p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="week2.html" class="btn btn-neutral float-left" title="Week 2 (1/13 to 1/20)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, FRC Team 687.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>